{"version":3,"sources":["environment.js","elems/md-autocomplete.js","elems/md-button.js","elems/md-checkbox.js","elems/md-drawer.js","elems/md-input.js","elems/md-loading.js","elems/md-menu.js","elems/md-select.js","elems/md-shadow.js","elems/md-snackbar.js","elems/md-switch.js","elems/md-table.js","libs/csv.js","libs/environment.js","libs/pouch.js","resources/helpers.js","resources/value-converters.js","views/account.js","views/drugs.js","views/index.js","views/inventory.js","views/join.js","views/login.js","views/public.js","views/records.js","views/routes.js","views/shipments.js","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/elems/md-autocomplete.html","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/elems/md-button.html","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/elems/md-checkbox.html","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/elems/md-drawer.html","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/elems/md-input.html","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/elems/md-loading.html","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/elems/md-menu.html","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/elems/md-select.html","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/elems/md-snackbar.html","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/elems/md-switch.html","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/views/account.html","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/views/drugs.html","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/views/index.html","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/views/inventory.html","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/views/join.html","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/views/login.html","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/views/public.html","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/views/records.html","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/views/routes.html","/Users/akircher/Documents/Node/dscsa-repo/node_modules/client/src/views/shipments.html"],"names":["debug","testing","MdAutocompleteCustomElement","name","defaultBindingMode","twoWay","toggleResults","$event","setTimeout","showResults","MdButtonCustomElement","Element","element","change","bind","click","disabledOrInvalid","stopPropagation","disabledChanged","button","input","disabled","formElement","checkValidity","attached","form","closest","addEventListener","class","classList","add","split","color","slice","fab","style","height","width","parentElement","tagName","padding","MdCheckboxCustomElement","tabindex","tabIndex","e","stopPropogation","checkedChanged","checked","label","MaterialCheckbox","checkToggleState","checkDisabled","componentHandler","upgradeAllRegistered","drawer","document","createElement","MdDrawerCustomElement","autofocus","hasAttribute","appendChild","header","querySelector","parentNode","insertBefore","nextSibling","display","firstChild","detached","children","length","removeChild","MdInputCustomElement","valueChanged","div","MaterialTextfield","checkDirty","upgradeElement","placeholder","remove","input_","focus","MdLoadingCustomElement","val","MaterialProgress","setProgress","Math","min","MdMenuCustomElement","id","Date","now","querySelectorAll","li","MdSelectCustomElement","MdShadowCustomAttribute","getAttribute","MdSnackbarCustomElement","show","opts","message","timeout","MaterialSnackbar","showSnackbar","MdSwitchCustomElement","elem","MaterialSwitch","MdTableCustomAttribute","border","selectable","checkboxes","i","Csv","Db","expShortcuts","qtyShortcuts","incrementBox","saveTransaction","scrollSelect","focusInput","toggleDrawer","drugSearch","parseUserDate","toJsonDate","waitForDrugsToIndex","canActivate","$index","which","clearIfAsterick","transaction","location","call","shiftKey","target","value","_saveTransaction","Promise","resolve","then","db","put","catch","snackbar","err","reason","curr","list","cb","index","indexOf","last","selector","fallback","console","log","term","trim","_search","drug","get","test","ndc","generic","date","year","pop","month","shift","setDate","toJSON","drugIsIndexed","drugsIndexed","_","next","router","user","session","loggedIn","account","navigation","route","isVisible","config","roles","navModel","nav","currentInstruction","jsonValueConverter","toView","object","JSON","stringify","numberValueConverter","fromView","str","upperCaseValueConverter","toUpperCase","shipmentFilterValueConverter","shipments","filter","toLowerCase","shipment","from","to","tracking","status","createdAt","drugFilterValueConverter","drugs","replace","regex","RegExp","join","recordFilterValueConverter","days","day","userFilterValueConverter","users","first","valueValueConverter","transactions","decimals","trigger","Array","isArray","reduce","total","price","qty","goodrx","nadac","toFixed","boldValueConverter","text","bold","dateValueConverter","model","view","includes","sub","toArrayValueConverter","obj","sort","arr","Object","keys","map","key","inventoryFilterValueConverter","exp","_id","count","isChecked","activate","accounts","selectUser","saveUser","addUser","unshift","post","deleteUser","delete","splice","authorize","authorized","auth","push","logout","disableLogout","navigate","trace","csv","scrollDrugs","deactivate","removeEventListener","params","ordered","selectDrawer","selectDrug","scrollGroups","group","groups","selectGroup","autoselectDrug","inventory","search","autoselectGroup","generics","url","order","undefined","saveOrder","exportOrdered","orders","all","unparse","exportDrugs","upc","ndc9","strength","importDrugs","start","capitalize","l","parse","$file","files","parsed","brand","image","labeler","v","rows","addGeneric","removeGeneric","forms","dispatchEvent","Event","addDrug","_savingDrug","saveDrug","deleteDrug","configure","aurelia","warnings","use","standardConfiguration","plugin","globalResources","a","setRoot","limit","resetFilter","assign","b","aExp","bExp","aQty","bQty","aBox","bBox","signalFilter","repackInventory","repack","dispensed","dispensedAt","boxShortcuts","exportCSV","row","importCSV","_rev","pkg","chain","args","r","http","license","street","city","state","zip","email","phone","password","loading","resources","progress","syncing","login","records","history","scroll","today","setHours","selectDay","query","$gte","$lte","selectTransaction","k","o","pad","word","repeat","reverse","href","type","App","configureRouter","routes","title","moduleId","stati","expShortcutsKeydown","qtyShortcutsKeydown","$gt","$in","fromAccounts","toAccounts","fromShipments","toShipments","selected","fromMap","toMap","makeMap","makeReference","setStatus","forEach","role","partner","selectShipment","emptyShipment","setUrl","setShipment","setTransactions","shipmentId","attachment","diffs","setCheckboxes","verifiedAt","prev","swapRole","saveShipment","moveTransactionsToShipment","createShipment","expShortcutsInput","autoCheck","qtyShortcutsInput","deleteTransactionIfQty0","doneeDelete","donorDelete","getLocation","getOrder","defaultLocation","_location","setLocation","aboveMinQty","defaultQty","minQty","aboveMinExp","minDays","belowMaxInventory","newInventory","maxInventory","isNaN","isWanted","setDestroyedMessage","destroyedMessage","clearDestroyedMessage","clearTimeout","verifiedMessage","toggleVerified","toggleDiff","manualCheck","moveItemsButton","offsetParent","newShipmentButton","autocompleteShortcuts","addTransaction","isPharMerica","error"],"mappings":"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","file":"app-bundle.js","sourcesContent":["export default {\n  debug: true,\n  testing: true\n};\n","import {bindable, bindingMode} from 'aurelia-framework';\n\n@bindable({name:'value', defaultBindingMode: bindingMode.twoWay})\n@bindable('disabled')\n@bindable('placeholder')\nexport class MdAutocompleteCustomElement {\n  toggleResults($event) {\n    //Foucusout removes the results from the view before the click on\n    //the selected result can register.  Delaying a bit prevents this\n    //http://stackoverflow.com/questions/18848738/click-event-not-triggered-after-focusout-event\n    setTimeout(() => this.showResults = ! this.showResults, 200)\n  }\n}\n","import {bindable, inject} from 'aurelia-framework';\n\n@bindable('form')\n@bindable('class')\n@bindable('raised')\n@bindable('fab')\n@bindable('disabled')\n@bindable('color')\n@inject(Element)\nexport class MdButtonCustomElement {\n\n  constructor(element) {\n    this.element = element\n    this.change  = this.change.bind(this)\n  }\n\n  //click.trigger won't trigger when button is disabled, but delegate will\n  //but we cant use trigger because $parent's delegate will still fire regardless\n  //so use delegate, but for some reason delegate stops bubbling even if we do\n  //\"return true\" so we need to to refire the event.\n  click($event) {\n    this.disabledOrInvalid && $event.stopPropagation()\n  }\n\n  disabledChanged() {\n    this.button && this.change()\n  }\n\n  change(input) {\n    this.disabledOrInvalid = this.disabled || this.disabled === '' || (this.formElement && ! this.formElement.checkValidity())\n  }\n\n  attached() {\n    //TODO allow attribute value to specify the form by name.\n    //TODO a detached method.  Are these event listeners leaking?\n    if (this.form === '') {\n      this.formElement = this.element.closest('form')\n      this.formElement.addEventListener('change', this.change)\n      this.formElement.addEventListener('input', this.change)\n    }\n\n    //When going \"back\" to \"Create New Shipment\" form.checkValidity() would return true\n    //initially and then turn to false. setTimeout seems to eliminate this problem\n    setTimeout(this.change)\n\n    this.class && this.button.classList.add(...this.class.split(' '))\n    //attributes are made an empty string by default, so we can't just test for truthiness\n    //primary and accent are dynamic/reactive based on disable so need to be in the template.\n    if (typeof this.color == 'string' && this.color.slice(0, 4) != 'mdl-') {\n      this.color = 'mdl-button--'+(this.color || 'colored')\n    }\n\n    if (this.fab > 0) {\n      this.button.classList.add('mdl-button--fab')\n      this.button.style.height = this.fab+'px'\n      this.button.style.width  = this.fab+'px'\n      this.button.style['min-width'] = this.button.style.width\n      this.button.style['font-size'] = this.fab*.75+'px'\n      this.button.style['line-height'] = this.fab+'px'\n      //this.button.style['min-width'] = this.element.fab+'px'\n    }\n\n    if(this.element.parentElement.tagName == 'MD-DRAWER') {\n      this.button.style.width = \"100%\"\n      this.button.style.height = \"auto\"\n      this.button.style.padding = \"16px 8px\"\n      this.button.style['line-height'] = \"18px\"\n      this.button.style['text-align'] = \"left\"\n    }\n  }\n\n}\n","import {bindable, bindingMode, inject} from 'aurelia-framework';\n\n@bindable({name:'checked', defaultBindingMode: bindingMode.twoWay})\n@bindable('disabled')\n@bindable('required')\n@inject(Element)\nexport class MdCheckboxCustomElement {\n\n  constructor(element) {\n    this.tabindex = element.tabIndex\n    //Can't do this with <template click.delegate> since that overwrites authors delegate fn\n    element.addEventListener('click', e => this.disabled && e.stopPropagation())\n  }\n\n  //A click on input causes a UI change and then if aurelia is also listening for a\n  //click that causes a state change, then the two state changes cancel and it looks\n  //like the switch is locked.  Prevent this from happening.\n  stopPropogation() {\n    return true\n  }\n\n  //If we are relying on parent method returning true then this isn't needed,\n  //but if we are binding to check to change it programmatically we need this\n\n  checkedChanged() {\n    this.checked = !! this.checked //force boolean or we get weird behavior\n    setTimeout(_ => this.label && this.label.MaterialCheckbox.checkToggleState()) //checked hasn't actually been changed yet so wait for the change and then check\n  }\n\n  disabledChanged() {\n    setTimeout(_ => this.label && this.label.MaterialCheckbox.checkDisabled()) //disabled hasn't actually been changed yet so wait for the change and then check\n  }\n\n  attached() {\n    componentHandler.upgradeAllRegistered()\n    this.checkedChanged()\n    this.disabledChanged()\n  }\n}\n","import {inject} from 'aurelia-framework';\n\nlet drawer = document.createElement('nav')\ndrawer.classList.add(\"mdl-layout__drawer\")\n//console.log('drawer was created')\n\n@inject(Element)\nexport class MdDrawerCustomElement {\n\n  constructor(element) {\n    element.classList.add(\"mdl-navigation\")\n    element.style['padding-top'] = '6px'\n\n    this.autofocus = element.hasAttribute('autofocus')\n    //Move md-nav into the drawer\n    drawer.appendChild(element)\n    //console.log('drawer was constructed')\n  }\n\n  attached() {\n    this.header = document.querySelector('.mdl-layout__header')\n    this.header.parentNode.insertBefore(drawer, this.header.nextSibling)\n\n    componentHandler.upgradeAllRegistered()\n    //componentHandler.upgradeDom()\n\n    this.button = document.querySelector('.mdl-layout__drawer-button')\n\n    if (this.button)\n      this.button.style.display = 'block'\n\n    if (this.autofocus && this.header.firstChild)\n      this.header.firstChild.click()\n  }\n\n  detached() {\n    //New drawer is attached before old drawer is detached so children.length == 2\n    //except if going to view without a drawer (e.g login) in which length == 1\n    //console.log('detached', drawer.children.length)\n    if (drawer.children.length == 1 && this.button)\n      this.button.style.display = 'none'\n\n    //Empty the drawer\n    drawer.removeChild(drawer.firstChild)\n  }\n}\n","import {inject, bindable, bindingMode} from 'aurelia-framework';\n\n@bindable({name:'value', defaultBindingMode: bindingMode.twoWay})\n@bindable('disabled')\n@bindable('pattern')\n@bindable('step')\n@bindable('type')\n@bindable('placeholder')\n@bindable('input')\n@bindable('max')\n@bindable('required')\n@bindable('minlength')\n@bindable('maxlength')\n@bindable('autofocus')\nexport class MdInputCustomElement {\n\n  valueChanged() {\n    setTimeout(_=> {\n      this.div && this.div.MaterialTextfield && this.div.MaterialTextfield.checkDirty()\n      this.div && this.div.MaterialTextfield && this.div.MaterialTextfield.checkValidity()\n    })\n  }\n\n  disabledChanged() {\n    setTimeout(_ => {\n      this.div && this.div.MaterialTextfield && this.div.MaterialTextfield.checkDisabled()\n      this.div && this.div.MaterialTextfield && this.div.MaterialTextfield.checkValidity()\n    }) //disabled hasn't actually been changed yet so wait for the change and then check\n  }\n\n  attached() {\n    componentHandler.upgradeElement(this.div)\n\n    if ( ! this.placeholder)\n      this.div.classList.remove('has-placeholder')\n\n    if (this.autofocus || this.autofocus === '')\n      this.div.MaterialTextfield.input_.focus()\n  }\n}\n","import {bindable, bindingMode, inject} from 'aurelia-framework';\n\n@bindable('value')\nexport class MdLoadingCustomElement {\n\n  valueChanged(val) {\n    setTimeout(_=> this.div && this.div.MaterialProgress.setProgress(Math.min(val, 100)))\n  }\n\n  attached() {\n    componentHandler.upgradeElement(this.div)\n  }\n}\n","import {bindable, inject} from 'aurelia-framework';\n\n@inject(Element)\nexport class MdMenuCustomElement {\n\n  constructor(element) {\n    //Router add both pages to view at same time.  This confuses the MDL library\n    //which add the button's click handler to the previous page rather than the\n    //next page since the two ids are the same.  Prevent this by randomly generating\n    //the id.  Also 'for.bind' doesn't seem to work so using synomym data-md-for\n    this.id = 'id'+Date.now()\n    this.element = element\n  }\n\n  attached() {\n    for (let li of this.element.querySelectorAll('li'))\n      li.classList.add('mdl-menu__item')\n  }\n}\n","import {bindable, bindingMode, inject} from 'aurelia-framework';\n\n@bindable({name:'value', defaultBindingMode: bindingMode.twoWay})\n@bindable('style')\n@bindable('options')\n@bindable('disabled')\n@bindable('default')\n@bindable('required')\n@bindable('property')\nexport class MdSelectCustomElement {\n\n  //need when toggling back and forth on shipments page to make sure from/to account disables where updated\n  disabledChanged() {\n    setTimeout(_=> this.div && this.div.MaterialTextfield.checkDisabled())\n  }\n\n  valueChanged() {\n    setTimeout(_=> this.div && this.div.MaterialTextfield.checkDirty())\n  }\n\n  attached() {\n    componentHandler.upgradeElement(this.div)\n  }\n}\n","import {inject} from 'aurelia-framework';\n\n@inject(Element)\nexport class MdShadowCustomAttribute {\n\n  constructor(element) {\n    element.classList.add(\"mdl-shadow--\"+element.getAttribute('md-shadow')+\"dp\")\n  }\n}\n","import {bindable, inject} from 'aurelia-framework';\n\n@bindable('show')\n@inject(Element)\nexport class MdSnackbarCustomElement {\n\n  constructor(element) {\n    this.element = element\n  }\n\n  attached() {\n    componentHandler.upgradeElement(this.element)\n    this.element.show = opts => {\n      if (typeof opts == 'string')\n        opts = {message:opts, timeout:5000}\n\n      this.element.MaterialSnackbar.showSnackbar(opts)\n    }\n  }\n}\n","import {bindable, bindingMode, inject} from 'aurelia-framework';\n\n@bindable({name:'checked', defaultBindingMode: bindingMode.twoWay})\n@bindable('disabled')\n@bindable('required')\n@inject(Element)\nexport class MdSwitchCustomElement {\n\n  constructor(elem) {\n    //Do not propogate click if element is disabled\n    //Can't do this with <template click.delegate> since that overwrites authors delegate fn\n    elem.addEventListener('click', e => this.disabled && e.stopPropagation())\n  }\n\n  //A click on input causes a UI change and then if aurelia is also listening for a\n  //click that causes a state change, then the two state changes cancel and it looks\n  //like the switch is locked.  Prevent this from happening.\n  //https://www.kirupa.com/html5/event_capturing_bubbling_javascript.htm\n  stopPropogation() {\n    return true\n  }\n\n  //If we are relying on parent returning true then this isn't needed, but\n  //if we are binding to check to change it programmatically we need this\n  checkedChanged() {\n    this.checked = !! this.checked\n    setTimeout(_ => this.label && this.label.MaterialSwitch.checkToggleState()) //checked hasn't actually been changed yet so wait for the change and then check\n  }\n\n  disabledChanged() {\n    setTimeout(_ => this.label && this.label.MaterialSwitch.checkDisabled()) //disabled hasn't actually been changed yet so wait for the change and then check\n  }\n\n  attached() {\n    componentHandler.upgradeElement(this.label)\n    this.checkedChanged()\n    this.disabledChanged()\n  }\n}\n","import {inject} from 'aurelia-framework';\n\n@inject(Element)\nexport class MdTableCustomAttribute {\n\n  constructor(element) {\n\n    element.classList.add(\"mdl-data-table\")\n    element.classList.add(\"mdl-js-data-table\")\n    element.style.border = \"none\"\n\n    if (element.getAttribute('md-table'))\n      element.classList.add(\"mdl-data-table--selectable\")\n\n    this.element = element\n    //this.checkboxes = element.querySelector('')\n  }\n\n  valueChanged(selectable) {\n\n    let checkboxes = this.element.querySelectorAll('input[type=\"checkbox\"]')\n\n    for (var i=0; i < checkboxes.length; i++) {\n      checkboxes[i].disabled = selectable == 'false'\n    }\n  }\n\n  attached() {\n\n    componentHandler.upgradeAllRegistered()\n  }\n}\n","export {Csv}\n","export default {\n  debug: true,\n  testing: true\n};\n","export {Db}\n","\nexport function expShortcuts($event, $index) {\n  //Enter should focus on quantity\n  if ($event.which == 13)\n    return this.focusInput(`#qty_${$index}`)\n\n  return true\n}\n\nexport function qtyShortcuts($event, $index) {\n  //Enter should focus on rx_input, unless it is hidden\n  if ($event.which == 13)\n    return this.focusInput(`#box_${$index}`, `md-autocomplete`)\n\n  return clearIfAsterick($event)\n}\n\nexport function incrementBox($event, transaction) {\n  if ($event.which == 107 || $event.which == 187) { // + key on numpad, keyboard\n    transaction.location = transaction.location[0]+(+transaction.location.slice(1)+1)\n    saveTransaction.call(this, transaction)\n    return false //don't actually add the +\n  }\n\n  if ($event.which == 109 || $event.which == 189) {// - key on numpad, keyboard\n    transaction.location = transaction.location[0]+(+transaction.location.slice(1)-1)\n    saveTransaction.call(this, transaction)\n    return false //don't actually add the -\n  }\n\n  return clearIfAsterick($event)\n}\n\nfunction clearIfAsterick($event) {\n  return $event.which == 106 || ($event.shiftKey && $event.which == 56) ? $event.target.value = \"\" : true\n}\n\nexport function saveTransaction(transaction) {\n  return this._saveTransaction = Promise.resolve(this._saveTransaction).then(_ => {\n    return this.db.transaction.put(transaction)\n  }).catch(err => {\n    delete this._saveTransaction\n    this.snackbar.show(`Error saving transaction: ${err.reason || err.message }`)\n    throw err\n  })\n}\n\nexport function scrollSelect($event, curr, list = [], cb) {\n\n  let index = list.indexOf(curr)\n  let last  = list.length - 1\n\n  if ($event.which == 38) //Keyup\n    cb.call(this, list[index > 0 ? index - 1 : last])\n\n  if ($event.which == 40) //keydown\n    cb.call(this, list[index < last ? index+1 : 0])\n}\n\nexport function focusInput(selector, fallback) {\n  let elem = document.querySelector(`${selector} input`)\n\n  if (elem && ! elem.disabled)\n    elem.focus()\n  else if (fallback)\n    document.querySelector(`${fallback} input`).focus()\n  else\n    console.log(`Cannot find ${selector} input`)\n\n  return false\n}\n\nexport function toggleDrawer() {\n  let drawer = document.querySelector('.mdl-layout__header')\n  drawer && drawer.firstChild.click() //view might not be attached yet meaning selector is null\n}\n\nexport function drugSearch() {\n  let term = (this.term || '').trim()\n\n  //always do searches serially\n  return this._search = Promise.resolve(this._search).then(_ => {\n    return this.db.drug.get(/^[\\d-]+$/.test(term) ? {ndc:term} : {generic:term})\n  })\n}\n\n//whether mm/yy or mm/dd/yy, month is always first and year is always last\nexport function parseUserDate(date) {\n  date = (date || \"\").split('/') //can't do default arugment because can be null as well as undefined\n  return {\n    year:date.pop(),\n    month:date.shift()\n  }\n}\n\n//To get last day in month, set it to next month and subtract a day\nexport function toJsonDate({month, year}) {\n  let date = new Date('20'+year,month, 1)\n  date.setDate(0)\n  return date.toJSON()\n}\n\n//Calls the direct query to pouch to wait on the drug database being synced. Then it\n//reopens the search field and changes the placeholder.\nexport function waitForDrugsToIndex(){\n  this.db.drug.drugIsIndexed.get().then(_ => {\n   this.drugsIndexed = true\n   this.placeholder = \"Search Drugs By Generic Name...\"\n  })\n}\n\nimport {Redirect} from 'aurelia-router'\n\nexport function canActivate(_, next, {router}) {\n  return this.db.user.session.get().then(session => {\n\n    let loggedIn = session && session.account\n\n    for (let route of router.navigation)\n        route.isVisible = loggedIn\n          ? route.config.roles && ~route.config.roles.indexOf('user')\n          : ! route.config.roles\n\n    let canActivate = next.navModel.isVisible || ! next.nav\n\n    return canActivate || router.currentInstruction\n      ? canActivate\n      : new Redirect(loggedIn ? 'shipments' : 'login')\n  })\n  .catch(err => console.log('loginRequired error', err))\n}\n"," import {toJsonDate, parseUserDate} from '../resources/helpers'\n\n//http://stackoverflow.com/questions/32017532/observe-property-on-an-array-of-objects-for-any-changes\nexport class jsonValueConverter {\n  toView(object = null){\n    return JSON.stringify(object, null, \" \")\n  }\n}\n\nexport class numberValueConverter {\n  fromView(str){\n    return str === '' ? null : +str\n  }\n}\n\nexport class upperCaseValueConverter {\n  fromView(str) {\n    return str == null ? null : str.toUpperCase()\n  }\n}\n\nexport class shipmentFilterValueConverter {\n  toView(shipments = [], filter = ''){\n    filter = filter.toLowerCase()\n    return shipments.filter(shipment => {\n      return ~ `${shipment.account.from.name} ${shipment.account.to.name} ${shipment.tracking} ${shipment.status} ${shipment.createdAt.slice(0, 10)}`.toLowerCase().indexOf(filter)\n    })\n  }\n}\n\nexport class drugFilterValueConverter {\n  toView(drugs = [], filter = ''){\n    filter = filter.replace('.', '\\\\.').split(/, |[, ]/g)\n    var regex = RegExp('(?=.*'+filter.join(')(?=.*( |0)')+')', 'i') //Use lookaheads to search for each word separately (no order).  Even the first term might be the 2nd generic\n    return drugs.filter(drug => regex.test(drug.generic))\n  }\n}\n\nexport class recordFilterValueConverter {\n  toView(days = [], filter = ''){\n    return days.filter(day => ~ day.indexOf(filter))\n  }\n}\n\n//TODO make this work with added items\nexport class userFilterValueConverter {\n  toView(users = [], filter = ''){\n    filter = filter.toLowerCase()\n    return users.filter(user => {\n      return ~ `${user.name.first} ${user.name.last}`.toLowerCase().indexOf(filter)\n    })\n  }\n}\n\nexport class valueValueConverter {\n  toView(transactions = [], decimals, trigger) {\n    transactions = Array.isArray(transactions) ? transactions : [transactions]\n\n    return transactions.reduce((total, transaction) => {\n      if ( ! transaction.drug.price || ! transaction.qty) return 0\n      let price = transaction.drug.price.goodrx || transaction.drug.price.nadac || 0\n      let   qty = transaction.qty.to || transaction.qty.from || 0\n      return total + qty * price\n    }, 0).toFixed(decimals)\n  }\n}\n\nexport class boldValueConverter {\n  toView(text, bold){\n    if ( ! bold || ! text) return text\n\n    if (typeof bold == 'string') //Handle a strength of 0.5mg and .5mg interchangeably\n      bold = RegExp('('+bold.replace(/ /g, '|').replace('.', '( | 0)?\\\\.')+')', 'gi')\n\n    return text.replace(bold, '<strong>$1</strong>')\n  }\n}\n\nexport class dateValueConverter {\n\n  toView(date) {\n    if ( ! date ) return ''\n    return date != this.model ? date.slice(5,7)+'/'+date.slice(2,4) : this.view\n  }\n\n  fromView(date){\n\n    if (date.includes('*'))\n      return null\n\n    let add = date.includes('+') || date.includes('=')\n    let sub = date.includes('-')\n\n    let {month, year} = parseUserDate(date.replace(/\\+|\\-|\\=/g, ''))\n\n    if (year.length > 2) //without this if user accidentally typed an extra character it would cause ongoing save error\n      year = year.slice(0, 2)\n\n    if (add) month++\n    if (sub) month--\n\n    if (month == 0) {\n      month = 12\n      year--\n    }\n\n    if (month == 13) {\n      month = 1\n      year++\n    }\n\n    //Keep zerp padding in front of the month which is lost when month changes\n    this.view = (\"00\"+month).slice(-2)+'/'+year\n\n    return this.model = toJsonDate({month, year})\n  }\n}\n\nexport class toArrayValueConverter {\n  toView(obj = {}, sort){\n\n    let arr = Object.keys(obj)\n\n    if (sort) arr.sort()\n\n    return arr.map(key => {\n      return {key, val:obj[key]}\n    })\n  }\n}\n\n//ADDED step of converting object to array\nexport class inventoryFilterValueConverter {\n  toView(transactions = [], filter){\n    for (let transaction of transactions) {\n      let exp  = transaction.exp.to || transaction.exp.from\n      let ndc  = transaction.drug._id\n      let form = transaction.drug.form\n      filter.exp[exp].count = 0\n      filter.exp[exp].qty = 0\n      filter.ndc[ndc].count = 0\n      filter.ndc[ndc].qty = 0\n      filter.form[form].count = 0\n      filter.form[form].qty = 0\n    }\n\n    transactions = transactions.filter(transaction => {\n\n      let qty  = transaction.qty.to || transaction.qty.from\n      let exp  = transaction.exp.to || transaction.exp.from\n      let ndc  = transaction.drug._id\n      let form = transaction.drug.form\n\n      if ( ! filter.exp[exp].isChecked) {\n        if (filter.ndc[ndc].isChecked && filter.form[form].isChecked) {\n          filter.exp[exp].count++\n          filter.exp[exp].qty += qty\n        }\n        return false\n      }\n      if ( ! filter.ndc[ndc].isChecked) {\n        if (filter.exp[exp].isChecked && filter.form[form].isChecked) {\n          filter.ndc[ndc].count++\n          filter.ndc[ndc].qty += qty\n        }\n        return false\n      }\n\n      if ( ! filter.form[form].isChecked) {\n        if (filter.exp[exp].isChecked && filter.ndc[ndc].isChecked) {\n          filter.form[form].count++\n          filter.form[form].qty += qty\n        }\n        return false\n      }\n\n      filter.exp[exp].count++\n      filter.ndc[ndc].count++\n      filter.form[form].count++\n      filter.exp[exp].qty   += qty\n      filter.ndc[ndc].qty   += qty\n      filter.form[form].qty += qty\n      return true\n    })\n\n    return transactions\n  }\n}\n","import {inject} from 'aurelia-framework';\nimport {Db}     from '../libs/pouch'\nimport {Router} from 'aurelia-router'\nimport {canActivate} from '../resources/helpers'\n\n//TODO this is causing Router to revert route and switches to not be upgraded @pageState()\n@inject(Db, Router)\nexport class account {\n\n  constructor(db, router){\n    this.db           = db\n    this.router       = router\n    this.canActivate  = canActivate\n  }\n\n  activate() {\n\n    this.db.user.session.get().then(session => {\n\n      this.session = session\n\n      //TODO allow a valueConverter for each state or do a new search\n      this.db.account.get().then(accounts => {\n        this.accounts = accounts.filter(account => {\n          if (account._id != session.account._id)\n            return true\n          this.account = account\n        })\n      })\n\n      return this.db.user.get().then(users => {\n        this.users = users\n        this.selectUser()\n      })\n    })\n  }\n\n  selectUser(user) {\n    this.user = user || this.users.filter(user => user._id == this.session._id)[0]\n  }\n\n  saveUser() {\n    this.user._id && this.db.user.put(this.user)\n    return true\n  }\n\n  addUser() {\n    this.users.unshift(this.user)\n    this.db.user.post(this.user)\n    .catch(err => {\n      this.users.shift()\n      this.snackbar.show(err.message || err.reason)\n    })\n  }\n\n  deleteUser() {\n    let index = this.users.indexOf(this.user)\n    this.db.user.delete(this.user).then(_ => {\n      this.users.splice(index, 1)\n      this.selectUser()\n    })\n    .catch(err => {\n      console.log(err)\n      this.snackbar.show(err.message || err.reason)\n    })\n  }\n\n  //Simple debounce doesn't work here to prevent double click\n  //because account is not authorized until the db returns\n  //which means isAuthorized isn't updated yet for the since click\n  authorize(_id) {\n    console.log('account.authorize', _id, this.account.authorized)\n    let index = this.account.authorized.indexOf(_id)\n    let auth  = this.db.account.authorized\n    ~ index\n      ? auth.delete({_id}).then(_ => this.account.authorized.splice(index, 1))\n      : auth.post({_id}).then(_ => this.account.authorized.push(_id))\n\n      return true\n    //TODO reset checkbox and show snackbar if change not made\n  }\n\n  logout() {\n    this.disableLogout = 'Uninstalling...'\n    this.db.user.session.delete().then(_ => {\n      this.router.navigate('login', {trigger:true})\n    })\n    .catch(err => console.trace('Logout failed: '+err))\n  }\n}\n","import {inject} from 'aurelia-framework'\nimport {Router} from 'aurelia-router'\nimport {Db}     from '../libs/pouch'\nimport {Csv}    from '../libs/csv'\nimport {canActivate, scrollSelect, toggleDrawer, drugSearch} from '../resources/helpers'\n\n\n//@pageState()\n@inject(Db, Router)\nexport class drugs {\n  //constructor(HttpClient = 'aurelia-http-client', Db = './pouch'){\n  constructor(db, router){\n    this.csv    = new Csv(['_id', 'generics', 'form'], ['brand', 'labeler', 'image'])\n    this.db     = db\n    this.router = router\n    this.term   = ''\n    this.scrollDrugs = this.scrollDrugs.bind(this)\n\n    this.toggleDrawer = toggleDrawer\n    this.scrollSelect = scrollSelect\n    this.drugSearch   = drugSearch\n    this.canActivate = canActivate\n  }\n\n  deactivate() {\n    removeEventListener('keyup', this.scrollDrugs)\n  }\n\n  activate(params) {\n    addEventListener('keyup', this.scrollDrugs)\n    return this.db.user.session.get()\n    .then(session => {\n      return this.db.account.get({_id:session.account._id})\n    })\n    .then(accounts => {\n      this.account = accounts[0]\n      this.drawer  = {\n        ordered:Object.keys(this.account.ordered).sort()\n      }\n\n      if ( ! params.id)\n        return this.drawer.ordered[0] && this.selectDrawer(this.drawer.ordered[0])\n\n      return this.db.drug.get({_id:params.id}).then(drugs => {\n        this.selectDrug(drugs[0], true)\n      })\n    })\n  }\n\n  scrollGroups($event) {\n    Promise.resolve(this._search).then(_ => {\n      //group won't be a reference so we must search manually\n      this.scrollSelect($event, this.group, this.groups, group => this.selectGroup(group, true))\n\n      if ($event.which == 13)//Enter get rid of the results\n        this.selectGroup(null, true)\n    })\n\n    $event.stopPropagation() //scrolling groups doesn't need to scroll drugs as well\n  }\n\n  scrollDrugs($event) {\n    this.group && this.scrollSelect($event, this.drug, this.group.drugs, this.selectDrug)\n  }\n\n  //Three entrances.\n  //1) User searches and then selects group from autocomplete (group already supplied)\n  //2) selectDrawer and we need to find the group with that particular generic name\n  //3) selectDrug and we need to find the group with that particular generic name\n  selectGroup(group, autoselectDrug) {\n    this.term = group.name\n\n    this.db.transaction.get({generic:group.name, inventory:\"sum\"}).then(inventory => {\n      this.inventory = inventory[0].qty\n    })\n\n    if ( ! group.drugs) //Not set if called from selectDrug or selectDrawer\n      group.drugs = this.search().then(_ => {\n        //Use filter to get an exact match not just one ingredient\n        return this.groups.length ? this.groups.filter(group => this.term == group.name)[0].drugs : []\n      })\n\n    Promise.resolve(group.drugs).then(drugs => {\n      group.drugs = drugs\n      this.group  = group\n      //TODO if this was called by selectDrug then we should establish establish a reference\n      //between the approriate this.group.drugs and this.drug so that changes to the drug\n      //appear in realtime on the right hand side.  This works if selectGroup\n      if (autoselectDrug)\n        this.selectDrug(group.drugs[0])\n    })\n  }\n\n  selectDrug(drug, autoselectGroup) {\n    //Default is for Add Drug menu item in view\n    this.drug = drug || {\n      generics:this.drug && this.drug.generics,\n      form:this.drug && this.drug.form\n    }\n\n    let url = this.drug ? 'drugs/'+this.drug._id : 'drugs'\n    this.router.navigate(url, { trigger: false })\n\n    if (autoselectGroup)\n      this.selectGroup({name:this.drug.generic || this.term})\n  }\n\n  selectDrawer(generic) {\n    this.selectGroup({name:generic}, true)\n    this.toggleDrawer()\n  }\n\n  search() {\n    return this.drugSearch().then(drugs => {\n      let groups = {}\n      for (let drug of drugs) {\n        groups[drug.generic] = groups[drug.generic] || {name:drug.generic, drugs:[]}\n        groups[drug.generic].drugs.push(drug)\n      }\n      this.groups = Object.keys(groups).map(key => groups[key])\n    })\n  }\n\n  //We might make a separate database and API out of this one day, but for now just save on account object.\n  //TODO: Warn on delete since we won't save save any of the preferences?\n  order() {\n    if (this.account.ordered[this.group.name]) {\n      //Delete this group from the drawer drawer\n      this.drawer.ordered = this.drawer.ordered.filter(generic => {\n        return generic != this.group.name\n      })\n\n      this.account.ordered[this.group.name] = undefined\n    } else {\n      //Add New Order but Keep Add New Item on Top\n      this.drawer.ordered.unshift(this.group.name)\n      this.account.ordered[this.group.name] = {}\n    }\n\n    this.saveOrder()\n  }\n\n  exportOrdered() {\n    this.snackbar.show(`Exporting orders as csv. This may take a few minutes`)\n    let csv    = new Csv(['generic'], ['inventory', 'maxInventory', 'minQty', 'minDays', 'verifiedMessage', 'destroyedMessage', 'defaultLocation'])\n    let orders = []\n    for (let generic in this.account.ordered) {\n      let order = this.account.ordered[generic]\n      orders.push(this.db.transaction.get({generic, inventory:\"sum\"}).then(inventory => {\n        order.generic   = generic\n        order.inventory = inventory[0]\n        return order\n      }))\n    }\n\n    Promise.all(orders).then(orders => csv.unparse('Orders.csv', orders))\n  }\n\n  exportDrugs() {\n    this.snackbar.show(`Exporting drugs as csv. This may take a few minutes`)\n    this.db.drug.get().then(drugs => {\n      this.csv.unparse('Drugs.csv', drugs.map(drug => {\n        return {\n          '':drug,\n          _id:\" \"+drug._id,\n          upc:\"UPC \"+drug.upc,\n          ndc9:\"NDC9 \"+drug.ndc9,\n          generics:drug.generics.map(generic => generic.name+\" \"+generic.strength).join(';'),\n          ordered:this.account.ordered[drug.generic]\n        }\n      }))\n    })\n  }\n\n  importDrugs() {\n    let start = Date.now()\n    this.snackbar.show(`Parsing csv file`)\n    function capitalize(text) {\n      return text ? text.trim().toLowerCase().replace(/\\b[a-z]/g, l => l.toUpperCase()) : text\n    }\n    function trim(text) {\n      return text ? text.trim() : text\n    }\n    this.csv.parse(this.$file.files[0]).then(parsed => {\n      this.$file.value = ''\n      return Promise.all(parsed.map(drug => {\n        return {\n          _id:trim(drug._id),\n          brand:trim(drug.brand),\n          form:capitalize(drug.form),\n          image:trim(drug.image),\n          labeler:capitalize(drug.labeler),\n          generics:drug.generics.split(\";\").filter(v => v).map(generic => {\n            let [name, strength] = generic.split(/(?= [\\d.]+)/)\n            return {\n              name:capitalize(name),\n              strength:trim(strength || '').toLowerCase().replace(/ /g, '')\n            }\n          }),\n          price:drug.price\n        }\n      }))\n    })\n    .then(rows => {\n      this.snackbar.show(`Parsed ${rows.length} rows. Uploading to server`)\n      return this.db.drug.post(rows)\n    })\n    .then(_ => this.snackbar.show(`Drugs import completed in ${Date.now() - start}ms`))\n    .catch(err => this.snackbar.show('Drugs not imported: '+err))\n  }\n\n  addGeneric() {\n    this.drug.generics.push({name:'', strength:''})\n    return true\n  }\n\n  removeGeneric() {\n    this.drug.generics.pop()\n    setTimeout(_ => document.forms[0].dispatchEvent(new Event('change')))\n    return true\n  }\n\n  // addPkgSize() {\n  //   this.drug.pkgs.push({code:'', size:''})\n  //   return true\n  // }\n  //\n  // removePkgSize() {\n  //   this.drug.pkgs.pop()\n  //   return true\n  // }\n\n  saveOrder() {\n    return this.db.account.put(this.account).catch(_ => {\n      this.snackbar.show(`Order could not be saved: ${err.reason || err.message}`)\n    })\n  }\n\n  addDrug() {\n    this._savingDrug = true\n    this.db.drug.post(this.drug)\n    .then(res => {\n      //Wait for the server POST to replicate back to client\n      setTimeout(_ => {\n        this._savingDrug = false\n        this.selectDrug(this.drug, true)\n      }, 1000)\n    })\n    .catch(err => {\n      this._savingDrug = false\n      this.snackbar.show(`Drug not added: ${err.reason || err.message}`)\n    })\n  }\n\n  saveDrug() {\n    this._savingDrug = true\n    this.db.drug.put(this.drug)\n    .then(res => {\n      //If we move the last drug out of the group, make sure we unorder it\n      if (\n        this.group.name != this.drug.generic &&\n        this.group.drugs.length == 1 &&\n        this.account.ordered[this.group.name]\n      ) this.order()\n\n      //Wait for the server PUT to replicate back to client\n      setTimeout(_ => {\n        this._savingDrug = false\n        this.selectDrug(this.drug, true)\n      }, 1000)\n    })\n    .catch(err => {\n      this._savingDrug = false\n      this.snackbar.show(`Drug not saved: ${err.reason || err.message}`)\n    })\n  }\n\n  deleteDrug() {\n    console.log('TO BE IMPLEMENETED')\n    //TODO complicated since drug might be used in a transaction.  Switch trans to a new drug\n  }\n}\n","export function configure(aurelia) {\n\n  Promise.config({warnings:false})\n  console.log = console.log.bind(console)\n\n  aurelia.use\n    .standardConfiguration()\n    .plugin('aurelia-animator-css')\n    .globalResources('resources/value-converters')\n\n  aurelia.start().then(a => a.setRoot('views/routes'));\n}\n","import {inject, buildQueryString} from 'aurelia-framework';\nimport {Db}     from '../libs/pouch'\nimport {Router} from 'aurelia-router';\nimport {Csv}    from '../libs/csv'\nimport {canActivate, expShortcuts, qtyShortcuts, incrementBox, saveTransaction, focusInput, scrollSelect, drugSearch, waitForDrugsToIndex} from '../resources/helpers'\n\n@inject(Db, Router)\nexport class inventory {\n\n  constructor(db, router){\n    this.db     = db\n    this.router = router\n    this.csv    = new Csv(['drug._id'], ['qty.from', 'qty.to', 'exp.from', 'exp.to', 'location', 'verifiedAt'])\n    this.limit  = 100\n\n    this.resetFilter()\n    this.placeholder     = \"Please Wait While the Drug Database is Indexed\" //Put in while database syncs\n    this.waitForDrugsToIndex = waitForDrugsToIndex\n    this.expShortcuts    = expShortcuts\n    this.qtyShortcuts    = qtyShortcuts\n    this.saveTransaction = saveTransaction\n    this.incrementBox    = incrementBox\n    this.focusInput      = focusInput\n    this.scrollSelect    = scrollSelect\n    this.drugSearch      = drugSearch\n    this.canActivate     = canActivate\n  }\n\n  activate(params) {\n\n    this.waitForDrugsToIndex()\n\n    if (Object.keys(params).length)\n      this.selectGroup(params)\n\n    this.db.user.session.get().then(session => {\n      return this.db.account.get({_id:session.account._id})\n    }).then(accounts => {\n      this.ordered = accounts[0].ordered\n    })\n  }\n\n  scrollGroups($event) {\n    this.scrollSelect($event, this.group, this.groups, this.selectGroup)\n\n    if ($event.which == 13)//Enter get rid of the results\n      this.focusInput(`#exp_0`)\n  }\n\n  selectGroup(group) {\n    this.router.navigate('inventory?'+buildQueryString(group), {trigger:false})\n    this.db.transaction.get(Object.assign({inventory:true}, group), {limit:this.limit})\n    .then(transactions => {\n      if (transactions.length == this.limit)\n        this.snackbar.show(`Displaying first 100 results`)\n\n      this.term  = group.generic || group.location || group.exp\n\n      this.group = group\n      this.transactions = transactions.sort((a, b) => {\n        let aExp = a.exp.to || a.exp.from || ''\n        let bExp = b.exp.to || b.exp.from || ''\n        let aQty = a.qty.to || a.qty.from || ''\n        let bQty = b.qty.to || b.qty.from || ''\n        let aBox = a.location || ''\n        let bBox = b.location || ''\n\n        if (aBox > bBox) return -1\n        if (aBox < bBox) return 1\n        if (aExp < bExp) return -1\n        if (aExp > bExp) return 1\n        if (aQty > bQty) return -1\n        if (aQty < bQty) return 1\n        return 0\n      })\n\n      this.resetFilter()\n      for (let transaction of this.transactions) {\n        this.filter.exp[transaction.exp.to || transaction.exp.from] = {isChecked:true, count:0, qty:0}\n        this.filter.ndc[transaction.drug._id]   = {isChecked:true, count:0, qty:0}\n        this.filter.form[transaction.drug.form] = {isChecked:true, count:0, qty:0}\n      }\n    })\n    .catch(console.log)\n  }\n\n  resetFilter() {\n    this.filter = {exp:{},ndc:{},form:{}}\n  }\n\n  search() {\n    if (/[A-Z][0-9]{3}/.test(this.term))\n      return this.selectGroup({location:this.term})\n\n    if (/20\\d\\d-\\d\\d-?\\d?\\d?/.test(this.term))\n      return this.selectGroup({exp:this.term})\n\n    this.drugSearch().then(drugs => {\n      let groups = {}\n      for (let drug of drugs) {\n        groups[drug.generic] = groups[drug.generic] || {generic:drug.generic}\n      }\n      this.groups = Object.keys(groups).map(key => groups[key]) //Polyfill for Object.values\n    })\n  }\n\n  signalFilter(obj) {\n    if (obj) obj.val.isChecked = ! obj.val.isChecked\n    this.filter = Object.assign({}, this.filter)\n  }\n\n  repackInventory() {\n    let repack = []\n    //since we are deleting as we go, loop backward\n    for (let i = this.transactions.length - 1; i >= 0; i--)  {\n      let transaction = this.transactions[i]\n      if (transaction.isChecked) {\n        transaction.next = transaction.next || []\n        transaction.next.push({qty:transaction.qty.to || transaction.qty.from, dispensed:{dispensedAt:new Date().toJSON()}})\n        this.transactions.splice(i, 1)\n        this.db.transaction.put(transaction).catch(err => {\n          transaction.next.pop()\n          this.transactions.splice(i, 0, transaction)\n          this.snackbar.show(`Error repacking: ${err.reason || err.message}`)\n        })\n      }\n    }\n  }\n\n  boxShortcuts($event, $index) {\n    if ($event.which == 13) //Enter should focus on next row's exp\n      return this.focusInput(`#exp_${$index+1}`)\n\n    return this.incrementBox($event, this.transactions[$index])\n  }\n\n  exportCSV() {\n    let name = 'Inventory.csv'\n    this.db.transaction.get({inventory:true}).then(inventory => {\n      this.csv.unparse(name, inventory.map(row => {\n        row.next = JSON.stringify(row.next || [])\n        return row\n      }))\n    })\n  }\n\n  importCSV() {\n    console.log('this.$file.value', this.$file.value)\n    this.csv.parse(this.$file.files[0]).then(parsed => {\n      return Promise.all(parsed.map(transaction => {\n        this.$file.value = ''  //Change event only fires if filename changed.  Manually set to blank in case user re-uploads same file (name)\n        transaction._id          = undefined\n        transaction._rev         = undefined\n        transaction.next         = JSON.parse(transaction.next || \"[]\")\n        return this.db.drug.get({_id:transaction.drug._id}).then(drugs => {\n          //This will add drugs upto the point where a drug cannot be found rather than rejecting all\n          if ( ! drugs[0])\n            throw 'Cannot find drug with _id '+transaction.drug._id\n\n          transaction.drug = {\n            _id:drugs[0]._id,\n            brand:drugs[0].brand,\n            generic:drugs[0].generic,\n            generics:drugs[0].generics,\n            form:drugs[0].form,\n            price:drugs[0].price,\n            pkg:drugs[0].pkg\n          }\n\n          return transaction\n        })\n        .catch(drug => {\n          console.log('Missing drug', transaction.drug._id, transaction.drug)\n          throw drug\n        })\n      }))\n    })\n    .then(rows => {\n      let chain = Promise.resolve()\n      for (let i = 0; i < rows.length; i += 36*30-1) {\n        chain = chain.then(_ => {\n          let args = rows.slice(i, i+36*30-1)\n          args = args.map(row => this.db.transaction.post(row))\n          args.push(new Promise(r => setTimeout(r, 4000)))\n          return Promise.all(args)\n        })\n        .catch(err => {\n          console.log('importCSV error',  i, i+36*30-1, err)\n          this.snackbar.show('Error Importing Inventory: '+JSON.stringify(err))\n        })\n      }\n      return chain\n    })\n    .then(_ => this.snackbar.show(`Imported Inventory Items`))\n  }\n}\n","import {inject}     from 'aurelia-framework'\nimport {Router}     from 'aurelia-router'\nimport {Db}         from '../libs/pouch'\nimport {HttpClient} from 'aurelia-http-client'\nimport {canActivate} from '../resources/helpers'\n\n//@pageState()\n@inject(Db, Router, HttpClient)\nexport class join {\n\n  constructor(db, router, http){\n    this.db     = db\n    this.router = router\n    this.http   = http\n\n    this.account = {\n      name:'',\n      license:'Pharmacy',\n      street:'',\n      city:'',\n      state:'OR',\n      zip:'',\n      ordered:{}\n    }\n\n    this.user = {\n      name:{first:'Guest',last:'User'},\n      email:'',\n      phone:'650.488.7434'\n    }\n    this.canActivate = canActivate\n  }\n\n  join() {\n    this.db.account.post(this.account)\n    .then(account => {\n      this.user.account = {_id:account._id}\n      return this.db.user.post(this.user)\n    })\n    .then(_ => {\n      return this.db.user.session.post({email:this.user.email, password:this.user.password})\n    })\n    .then(loading => {\n      //wait for all resources except 'drugs' to sync .filter(r => r.name != 'drugs')\n      this.disabled = true\n      this.loading  = loading.resources\n      this.progress = loading.progress\n\n      return Promise.all(loading.syncing)\n    })\n    .then(_ => {\n      console.log('join success', _)\n      return this.router.navigate('shipments')\n    })\n    .catch(err => {\n      this.snackbar.show('Join failed: '+err.reason || err.message)\n    })\n  }\n}\n","import {inject} from 'aurelia-framework'\nimport {Router} from 'aurelia-router'\nimport {Db}     from '../libs/pouch'\nimport {canActivate} from '../resources/helpers'\n\n\n@inject(Db, Router)\nexport class login {\n\n  constructor(db, router){\n    this.db          = db\n    this.router      = router\n    this.email       = 'oregon@sirum.org'\n    this.password    = ''\n    this.canActivate = canActivate\n  }\n\n  login() {\n    this.db.user.session.post({email:this.email, password:this.password})\n    .then(loading => {\n      this.disabled = true\n\n      //wait for all resources except 'drugs' to sync\n      this.loading  = loading.resources\n      this.progress = loading.progress\n\n      return Promise.all(loading.syncing)\n    })\n    .then(resources => {\n      this.router.navigate('shipments')\n    })\n    .catch(err => {\n      this.disabled = false\n      console.log('Login failed: ', err)\n      this.snackbar.show('Login failed: '+err.reason || err.message)\n    })\n  }\n}\n","import {inject} from 'aurelia-framework';\nimport {Db}     from '../libs/pouch'\nimport {canActivate} from '../resources/helpers'\n\n@inject(Db)\nexport class inventory {\n\n  constructor(db){\n    this.db = db\n    this.db.user.session.get().then(session => this.session = session)\n    this.db.transaction.get({inventory:\"sum\"}).then(inventory => this.inventory = inventory)\n    this.canActivate = canActivate\n  }\n}\n","//TODO\n//Autofocus on new drug\n//Disable From/To based on Filter's switch\n\nimport {inject}     from 'aurelia-framework';\nimport {Router}     from 'aurelia-router';\nimport {Db}         from '../libs/pouch'\nimport {HttpClient} from 'aurelia-http-client';\nimport {canActivate, toggleDrawer} from '../resources/helpers'\n\n//@pageState()\n@inject(Db, Router, HttpClient)\nexport class records {\n\n  constructor(db, router, http){\n    this.db      = db\n    this.router  = router\n    this.http    = http\n    this.history = ''\n    this.days    = []\n    this.scroll  = this.scroll.bind(this)\n    this.toggleDrawer = toggleDrawer\n    this.canActivate = canActivate\n\n    let today  = new Date();\n    let start  = new Date(2016, 7, 1)\n\n    while (today > start) {\n      this.days.push(today.toJSON().slice(0, 10))\n      today.setHours(-24)\n    }\n  }\n\n  deactivate() {\n    removeEventListener('keyup', this.scroll)\n  }\n\n  activate(params) {\n    addEventListener('keyup', this.scroll)\n    this.db.user.session.get().then(session => {\n      this.account = session.account //this is not a full account, just an _id\n      this.selectDay(params.id) //TODO save day in parameter for browser reloads\n    })\n  }\n\n  selectDay(day, toggleDrawer) {\n    this.day = day || this.days[0]\n    this.router.navigate('records/'+this.day, { trigger: false })\n    toggleDrawer && this.toggleDrawer()\n\n    //Just in case the user inverts the to & from dates.\n    // let from = fromDate <= toDate ? fromDate : toDate\n    // let to   = fromDate > toDate ? fromDate : toDate\n    let to = new Date(this.day)\n    to.setHours(24*2)\n\n    //Do not show inventory $eq, $lt, $gt,\n    let query = {createdAt:{$gte:this.day, $lte:to.toJSON().slice(0, 10)}}\n\n    return this.db.transaction.get(query).then(transactions => {\n      this.transactions = transactions\n      return this.selectTransaction()\n    })\n  }\n\n  scroll($event) {\n    let index = this.transactions.indexOf(this.transaction)\n    let last  = this.transactions.length - 1\n\n    if ($event.which == 38) //Keyup\n      this.selectTransaction(this.transactions[index > 0 ? index - 1 : last])\n\n    if ($event.which == 40) //keydown\n      this.selectTransaction(this.transactions[index < last ? index+1 : 0])\n  }\n//this.http.get('//localhost:3000/transactions/'+transaction._id+'/history')\n  //Activated from constructor and each time a transaction is selected\n  selectTransaction(transaction) {\n    this.transaction = transaction || this.transactions[0]\n\n    if ( ! this.transaction) return\n\n    this.db.transaction.get({_id:this.transaction._id}, {history:true})\n    .then(history => {\n      //TODO move this to /history?text=true. Other formatting options?\n      function id(k,o) {\n        //console.log(o, typeof o)\n        if (Array.isArray(o))\n          return o\n        return o.shipment.from.name+' '+o._id\n      }\n      //console.log('history', JSON.stringify(history.content, id, \"*\"))\n      function pad(word) {\n        return (word+' '.repeat(25)).slice(0, 25)\n      }\n      this.history = JSON.stringify(\n        history.reverse(),\n        (k,v) => {\n          if (Array.isArray(v))\n            return v\n\n            let status = this.status || 'pickup' //Might not be initialized yet\n            let href   = '/#/shipments/'+v.shipment._id\n\n            return pad('From: '+v.shipment.account.from.name)+pad('To: '+v.shipment.account.to.name)+\"<a href='\"+href+\"'>\"+v.type+\" <i class='material-icons' style='font-size:12px; vertical-align:text-top; padding-top:1px'>exit_to_app</i></a><br>\"+\n                   pad(v.shipment.account.from.street)+pad(v.shipment.account.to.street)+'Date '+v.createdAt.slice(2, 10)+'<br>'+\n                   pad(v.shipment.account.from.city+', '+v.shipment.account.from.state+' '+v.shipment.account.from.zip)+pad(v.shipment.account.to.city+', '+v.shipment.account.to.state+' '+v.shipment.account.to.zip)+'Quantity '+(v.qty.to || v.qty.from)\n        },\n        \"   \"\n      )\n      .replace(/\\[\\n?\\s*/g, \"<div style='margin-top:-12px'>\")\n      .replace(/\\n?\\s*\\],?/g, '</div>')\n      .replace(/ *\"/g, '')\n      .replace(/\\n/g, '<br><br>')\n    })\n  }\n\n  exportCSV() {\n\n  }\n}\n","//@pageState()\nexport class App {\n\n  configureRouter(config, router){\n    this.routes  = router.navigation\n    config.title = 'SIRUM'\n    config.map([\n      { route: 'inventory/:id',                    moduleId: 'views/public',    title:'Inventory'},\n      { route: 'login',                            moduleId: 'views/login',     title:'Login',     nav:true},\n      { route: 'join',                             moduleId: 'views/join',      title:'Join',      nav:true},\n      { route: 'inventory',                        moduleId: 'views/inventory', title:'Inventory', nav:true, roles:[\"user\"]},\n      { route: ['shipments', 'shipments/:id', ''], moduleId: 'views/shipments', title:'Shipments', nav:true, roles:[\"user\"]},\n      { route: ['drugs', 'drugs/:id'],             moduleId: 'views/drugs',     title:'Drugs',     nav:true, roles:[\"user\"]},\n      { route: ['records', 'records/:id'],         moduleId: 'views/records',   title:'Records',   nav:true, roles:[\"user\"]},\n      { route: 'account',                          moduleId: 'views/account',   title:'Account',   nav:true, roles:[\"user\"]}\n    ])\n  }\n}\n","import {inject}     from 'aurelia-framework'\nimport {Router}     from 'aurelia-router'\nimport {Db}         from '../libs/pouch'\nimport {HttpClient} from 'aurelia-http-client'\nimport {Csv}        from '../libs/csv'\nimport {canActivate, expShortcuts, qtyShortcuts, incrementBox, saveTransaction, focusInput, scrollSelect, toggleDrawer, drugSearch, waitForDrugsToIndex} from '../resources/helpers'\n\n//@pageState()\n@inject(Db, Router, HttpClient)\nexport class shipments {\n\n  constructor(db, router, http){\n    this.csv    = new Csv(['drug._id'], ['qty.from', 'qty.to', 'exp.from', 'exp.to', 'location', 'verifiedAt'])\n    this.db     = db\n    this.drugs  = []\n    this.router = router\n    this.http   = http\n    this.stati  = ['pickup', 'shipped', 'received']\n    this.shipments = {}\n\n    this.placeholder     = \"Please Wait While the Drug Database is Indexed\" //Placeholder while database is indexing\n    this.waitForDrugsToIndex = waitForDrugsToIndex\n    this.expShortcutsKeydown = expShortcuts\n    this.qtyShortcutsKeydown = qtyShortcuts\n    this.incrementBox    = incrementBox\n    this.saveTransaction = saveTransaction\n    this.focusInput      = focusInput\n    this.scrollSelect    = scrollSelect\n    this.toggleDrawer    = toggleDrawer\n    this.drugSearch      = drugSearch\n    this.canActivate     = canActivate\n  }\n\n  activate(params) {\n    return this.db.user.session.get()\n    .then(session  => {\n      this.user = session._id\n      return this.db.account.get({_id:session.account._id})\n    })\n    .then(accounts => {\n      this.account = {_id:accounts[0]._id, name:accounts[0].name}\n      this.ordered = {[accounts[0]._id]:accounts[0].ordered}\n      return Promise.all([\n        //Start all of our async tasks\n        this.db.account.get({authorized:accounts[0]._id}),\n        this.db.account.get({_id:{$gt:null, $in:accounts[0].authorized}}),\n        this.db.shipment.get({'account.from._id':accounts[0]._id}), //TODO this should be duplicative with _security doc.  We should be able to do _all_docs or no selector\n        this.db.shipment.get({'account.to._id':accounts[0]._id})\n      ])\n    })\n    .then(([fromAccounts, toAccounts, fromShipments, toShipments]) => {\n      //This abbreviated denormalized account information will be assigned to account.to/from\n      let selected, fromMap = {}, toMap = {}\n      let makeMap = (map, account) => {\n        map[account._id] = {_id:account._id, name:account.name}\n        this.ordered[account._id] = account.ordered\n      }\n\n      for (let account of fromAccounts) makeMap(fromMap, account)\n      for (let account of toAccounts) makeMap(toMap, account)\n\n      this.accounts  = {\n        from:['', ...Object.keys(fromMap).map(key => fromMap[key])],\n        to:['', ...Object.keys(toMap).map(key => toMap[key])]\n      }\n\n      //Selected account != shipment.account.to because they are not references\n      let makeReference = shipment => {\n        this.setStatus(shipment)\n\n        //3 scenarios - from an approved partner, the current facility, from a previous approved partner\n        //TODO this code seems bulks is there a more elegant way to handle these three scenarios\n        if (toMap[shipment.account.from._id])\n          shipment.account.from = toMap[shipment.account.from._id]\n\n        if (fromMap[shipment.account.to._id])\n          shipment.account.to = fromMap[shipment.account.to._id]\n\n        if (params.id === shipment._id)\n          selected = shipment  //Sneak this in since we are already making the loop\n      }\n      fromShipments.forEach(makeReference)\n\n      this.role = selected //switch default role depending on shipment selection\n        ? {account:'from', partner:'to'}\n        : {account:'to', partner:'from'}\n\n      toShipments.forEach(makeReference)\n\n      //console.log('this.accounts', this.accounts)\n      this.shipments = {from:fromShipments, to:toShipments}\n\n      this.selectShipment(selected)\n      this.waitForDrugsToIndex()\n    })\n  }\n\n  //Activated by activate() and each time a shipment is selected from drawer\n  selectShipment(shipment, toggleDrawer) {\n    if (toggleDrawer)\n      this.toggleDrawer()\n\n    if ( ! shipment) return this.emptyShipment()\n    this.setUrl('/'+shipment._id)\n    this.setShipment(shipment)\n    this.setTransactions(shipment._id)\n  }\n\n  emptyShipment() {\n    this.setUrl('')\n    if (this.role.account == 'from') {\n      this.setShipment({account:{from:this.account, to:{}}})\n      this.setTransactions(this.account._id)\n    } else {\n      this.setShipment({account:{to:this.account, from:{}}})\n      this.setTransactions()\n    }\n  }\n\n  setShipment(shipment) {\n    this.shipment     = shipment\n    this.shipmentId   = shipment._id  //freeze this if user started playing with \"move shipment\" select\n    this.attachment   = null\n  }\n\n  setUrl(url) {\n    this.router.navigate('shipments'+url, { trigger: false})\n  }\n\n  setTransactions(shipmentId) {\n\n    this.diffs = [] //Newly checked or unchecked checkboxes. Used to disable buttons if user has not done anything yet\n\n    if ( ! shipmentId)\n      return this.transactions = []\n\n    this.db.transaction.get({'shipment._id':shipmentId}).then(transactions => {\n      this.transactions = transactions\n      this.setCheckboxes()\n    })\n    .catch(err => console.log('err', err))\n  }\n\n  setCheckboxes() {\n    for (let transaction of this.transactions) {\n      transaction.isChecked = this.shipmentId == this.shipment._id ? transaction.verifiedAt : null\n    }\n  }\n\n  setStatus(shipment) {\n    shipment.status = this.stati.reduce((prev, curr) => shipment[curr+'At'] ? curr : prev)\n  }\n\n  swapRole() { //Swap donor-donee roles\n    [this.role.account, this.role.partner] = [this.role.partner, this.role.account]\n    this.selectShipment()\n    return true\n  }\n\n  //Save the donation if someone changes the status/date\n  saveShipment() {\n    //don't want to save status, but deleting causes weird behavior\n    //so instead copy the shipment and delete from copy then assign new rev\n    return this.db.shipment.put(this.shipment).then(res => {\n      this.setStatus(this.shipment)\n    })\n    //TODO reschedule pickup if a date was changed\n  }\n\n  //Move these items to a different \"alternative\" shipment then select it\n  //TODO need to select the new shipment once user confirms the move\n  moveTransactionsToShipment(shipment) {\n    //Change all selected transactions to the new or existing shipment\n    Promise.all(this.transactions.map(transaction => {\n      if (transaction.isChecked) {\n        transaction.shipment = {_id:shipment._id}\n        return this.db.transaction.put(transaction)\n      }\n    }))\n    .then(_ => this.selectShipment(shipment)) //Display existing shipment or the newly created shipment\n  }\n\n  //Create shipment then move inventory transactions to it\n  createShipment() {\n    if (this.shipment.tracking == 'New Tracking #')\n      delete this.shipment.tracking\n\n    this.db.shipment.post(this.shipment).then(res => {\n      this.setStatus(this.shipment)\n      this.shipments[this.role.account].unshift(this.shipment)\n      this.moveTransactionsToShipment(this.shipment)\n    })\n  }\n\n  //Split functionality into Keydown and Input listeners because (keydown is set in constructor)\n  //Don't put this code into input because enter (which == 13) does not trigger input event.\n  //Don't put input code here because would then need a setTimeout for the quantity to actually change\n  //and you would need to ignore non-input key values.  So it cleaner to just keep these listeners separate\n  expShortcutsInput($index) {\n    this.autoCheck($index)\n  }\n\n  //Split functionality into Keydown and Input listeners because (keydown is set in constructor)\n  //Don't put this code into input because enter (which == 13) does not trigger input event.\n  //Don't put input code here because would then need a setTimeout for the quantity to actually change\n  //and you would need to ignore non-input key values.  So it cleaner to just keep these listeners separate\n  qtyShortcutsInput($event, $index) {\n    //Only run autocheck if the transaction was not deleted\n    this.deleteTransactionIfQty0($event, $index) && this.autoCheck($index)\n  }\n\n  deleteTransactionIfQty0($event, $index) {\n    //Delete an item in the qty is 0.  Instead of having a delete button\n\n    let transaction = this.transactions[$index]\n    let doneeDelete = ! transaction.qty.from && transaction.qty.to === 0\n    let donorDelete = ! transaction.qty.to   && transaction.qty.from === 0\n\n    if ( ! donorDelete && ! doneeDelete)\n      return true\n\n    this.drugs = [] //get rid of previous results since someone might press enter and accidentally readd the same drug\n    this.transactions.splice($index, 1) //Important to call splice before promise resolves since it will cancel the saveTransaction which would cause a conflict\n    this.db.transaction.delete(transaction)\n    this.focusInput(`md-autocomplete`)\n  }\n\n\n  boxShortcuts($event, $index) {\n    if ($event.which == 13)\n      return this.focusInput(`md-autocomplete`)\n\n    return this.incrementBox($event, this.transactions[$index])\n  }\n\n  getLocation(transaction) {\n    return (this.getOrder(transaction) || {}).defaultLocation || this._location\n  }\n\n  setLocation(transaction) {\n    if (this.getLocation(transaction) != transaction.location)\n      this._location = transaction.location //Only prepopulate non-default locations into next transaction\n  }\n\n  aboveMinQty(order, transaction) {\n    let qty = transaction.qty[this.role.account]\n    if ( ! qty) return false\n    let price      = transaction.drug.price.goodrx || transaction.drug.price.nadac || 0\n    let defaultQty = price > 1 ? 1 : 1 //keep expensive meds\n    let aboveMinQty = qty >= (+order.minQty || defaultQty)\n    if ( ! aboveMinQty) console.log('Ordered drug but qty', qty, 'is less than', +order.minQty || defaultQty)\n    return qty >= (+order.minQty || defaultQty)\n  }\n\n  aboveMinExp(order, transaction) {\n    let exp = transaction.exp[this.role.account]\n    if ( ! exp) return ! order.minDays\n    let minDays = order.minDays || 60\n    let aboveMinExp = new Date(exp) - Date.now() >= minDays*24*60*60*1000\n    if ( ! aboveMinExp) console.log('Ordered drug but expiration', exp, 'is before', minDays)\n    return aboveMinExp\n  }\n\n  belowMaxInventory(order, transaction) {\n    let newInventory = transaction.qty[this.role.account] + order.inventory\n    let maxInventory = order.maxInventory || 3000\n    let belowMaxInventory = isNaN(newInventory) ? true : newInventory < maxInventory //in case of an inventory error let's keep the drug\n    if ( ! belowMaxInventory) console.log('Ordered drug but inventory', newInventory, 'would be above max of', maxInventory) //\n    return belowMaxInventory\n  }\n\n  getOrder(transaction) {\n    return this.ordered[this.shipment.account.to._id][transaction.drug.generic]\n  }\n\n  isWanted(order, transaction) {\n    return order ? this.belowMaxInventory(order, transaction) && this.aboveMinQty(order, transaction) && this.aboveMinExp(order, transaction) : false\n  }\n\n  //If qty is 30 and user types \"3\" then destroyed message will display before user can type \"0\"\n  //this code puts a delay on the destroyed message and then clears it out if the user does type a \"0\"\n  //an alternative would be wait to trigger autocheck until enter is pressed but this would delay all messages\n  setDestroyedMessage(order) {\n    if (order && order.destroyedMessage && ! this.destroyedMessage)\n      this.destroyedMessage = setTimeout(_ => {\n        delete this.destroyedMessage\n        this.snackbar.show(order.destroyedMessage)\n      }, 500)\n  }\n\n  clearDestroyedMessage() {\n    clearTimeout(this.destroyedMessage)\n    delete this.destroyedMessage\n  }\n\n  //TODO should this only be run for the recipient?  Right now when donating to someone else this still runs and displays order messages\n  autoCheck($index) {\n    let transaction = this.transactions[$index]\n    let isChecked   = transaction.isChecked\n    let order       = this.getOrder(transaction)\n\n    if(this.isWanted(order, transaction) == isChecked)\n      return ! isChecked && transaction.qty.to > 0 && this.setDestroyedMessage(order) //isChecked may have never alternated for a destroyed drug so need to check\n\n    if (isChecked)\n      this.setDestroyedMessage(order)\n\n    if ( ! isChecked) {//manual check has not switched the boolean yet\n      this.snackbar.show(order.verifiedMessage || 'Drug is ordered')\n      this.clearDestroyedMessage()\n    }\n\n    //this.manualCheck($index)\n  }\n\n  toggleVerified(transaction) {\n\n    let verifiedAt = transaction.verifiedAt\n    let location   = transaction.location\n\n    if (verifiedAt) {\n      transaction.verifiedAt = null\n      transaction.location   = null\n    } else {\n      transaction.verifiedAt = new Date().toJSON()\n      transaction.location   = this.getLocation(transaction)\n    }\n\n    this.saveTransaction(transaction).catch(err => {\n      transaction.isChecked  = ! transaction.isChecked\n      transaction.verifiedAt = verifiedAt\n      transaction.location   = location\n    })\n  }\n\n  toggleDiff(transaction) {\n    let index = this.diffs.indexOf(transaction)\n    ~ index\n      ? this.diffs.splice(index, 1)\n      : this.diffs.push(transaction)\n  }\n\n  manualCheck($index) {\n    let transaction = this.transactions[$index]\n\n    //If user is not moving items, the shipment exists, and they are the recipient, then autosave their verificaton\n    //offsetParent is null when buttons are hidden.  This keeps us from duplicating the show logic of the buttons here\n    if (this.moveItemsButton.offsetParent || this.newShipmentButton.offsetParent)\n      this.toggleDiff(transaction)\n    else\n      this.toggleVerified(transaction)\n\n    transaction.isChecked = ! transaction.isChecked\n  }\n\n  search() {\n    this.drugSearch().then(drugs => {\n      this.drugs = drugs\n      this.drug  = drugs[0]\n    })\n  }\n\n  //Enter in the autocomplete adds the selected transaction\n  //TODO support up/down arrow keys to pick different transaction?\n  autocompleteShortcuts($event) {\n\n    this.scrollSelect($event, this.drug, this.drugs, drug => this.drug = drug)\n\n    //Enter with a selected drug.  Force term to be falsey so a barcode scan which is entering digits does not trigger\n    if ($event.which == 13) {//Barcode scan means search might not be done yet\n      Promise.resolve(this._search).then(_ => this.addTransaction(this.drug))\n      return false //Enter was also triggering exp to qty focus\n    }\n\n    if ($event.which == 106 || ($event.shiftKey && $event.which == 56)) //* clearing autocomplete field with an asterick (to match exp date clearing and make numberpad compatible)\n      this.term = \"\"\n\n    return true  //still allow typing into autocomplete\n  }\n\n  addTransaction(drug, transaction) {\n\n    if ( ! drug)\n      return this.snackbar.show(`Cannot find drug matching this search`)\n\n    transaction = transaction || {\n      qty:{from:null, to:null},\n      exp:{\n        from:this.transactions[0] ? this.transactions[0].exp.from : null,\n        to:this.transactions[0] ? this.transactions[0].exp.to : null\n      }\n    }\n\n    transaction.drug = {\n      _id:drug._id,\n      brand:drug.brand,\n      generic:drug.generic,\n      generics:drug.generics,\n      form:drug.form,\n      price:drug.price,\n      pkg:drug.pkg\n    }\n\n    transaction.shipment = {\n      _id:this.shipment._id\n    }\n\n    transaction.user = {\n      _id:this.user\n    }\n\n    this.term = '' //Reset search's auto-complete\n\n    //Assume db query works.\n    this.transactions.unshift(transaction) //Add the drug to the view\n\n    let order        = this.getOrder(transaction)\n    let isPharMerica = /pharmerica.*/i.test(this.shipment.account.from.name)\n\n    //We set current inventory when adding a new transaction.  This is a tradeoff of frequency vs accurracy.  This will be inaccurate\n    //if user goes back and adjusts previous quantities to be higher since \"updating\" transaction would not trigger this code.  However,\n    //this is rare enough to be okay.  We also don't want to have to fetch current inventory on every input event.\n    order && this.db.transaction.get({generic:drug.generic, inventory:\"sum\"}).then(inventory => {\n      order.inventory = inventory[0].qty\n    })\n\n    isPharMerica && ! order //Kiah's idea of not making people duplicate logs for PharMerica, saving us some time\n      ? this.snackbar.show(`Destroy, record already exists`)\n      : setTimeout(_ => this.focusInput('#exp_0'), 50) // Select the row.  Wait for repeat.for to refresh (needed for dev env not live)\n\n    return this._saveTransaction = Promise.resolve(this._saveTransaction).then(_ => {\n      return this.db.transaction.post(transaction).catch(err => {\n        console.error(err)\n        this.snackbar.show(`Transaction could not be added: ${err.reason}`)\n        this.transactions.shift()\n      })\n    })\n  }\n\n  exportCSV() {\n    let name = this.shipment._id ? 'Shipment '+this.shipment._id+'.csv' : 'Inventory.csv'\n    this.csv.unparse(name, this.transactions.map(transaction => {\n      return {\n        '':transaction,\n        'next':JSON.stringify(transaction.next || []),\n        'drug._id':\" \"+transaction.drug._id,\n        'drug.generics':transaction.drug.generics.map(generic => generic.name+\" \"+generic.strength).join(';'),\n        shipment:this.shipment\n      }\n    }))\n  }\n\n  importCSV() {\n    console.log('this.$file.value', this.$file.value)\n    this.csv.parse(this.$file.files[0]).then(parsed => {\n      return Promise.all(parsed.map(transaction => {\n        this.$file.value = ''\n        transaction._id          = undefined\n        transaction._rev         = undefined\n        transaction.shipment._id = undefined\n        transaction.next         = JSON.parse(transaction.next)\n        return this.db.drug.get({_id:transaction.drug._id}).then(drugs => {\n          //This will add drugs upto the point where a drug cannot be found rather than rejecting all\n          if (drugs[0]) return {drug:drugs[0], transaction}\n          throw 'Cannot find drug with _id '+transaction.drug._id\n        })\n      }))\n    })\n    .then(rows => {\n      console.log('rows', rows)\n      return Promise.all(rows.map(row => this.addTransaction(row.drug, row.transaction)))\n    })\n    .then(_ => this.snackbar.show('All Transactions Imported'))\n    .catch(err => this.snackbar.show('Transactions not imported: '+err))\n  }\n\n  // setAttachment(attachment) {\n  //   attachment._id  = this.attachment.name\n  //   attachment._rev = this.shipment._rev\n  //   this.db.shipment.attachment.put({_id:this.shipment._id, attachment:attachment})\n  //   .then(res => {\n  //     this.shipment._rev   = res.rev\n  //     this.attachment.type = attachment.type\n  //     //TODO use service worker to rename this URL so title bar isn't nasty\n  //     //http://stackoverflow.com/questions/283956/is-there-any-way-to-specify-a-suggested-filename-when-using-data-uri\n  //     this.attachment.url  = URL.createObjectURL(attachment)\n  //     console.log('setAttachment', attachment, _)\n  //   })\n  // }\n  //\n  // getAttachment() {\n  //   this.db.shipment.attachment.get({_id:this.shipment._id, name:this.attachment.name})\n  //   .then(attachment => {\n  //     this.attachment.type = attachment.type\n  //     this.attachment.url  = URL.createObjectURL(attachment)\n  //     console.log('getAttachment', attachment, this.attachment.url)\n  //   })\n  //   .catch(this.attachment.url = null)\n  // }\n}\n",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"sourceRoot":"../src"}